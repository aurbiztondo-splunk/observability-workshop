<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.110.0"><meta name=generator content="Relearn 5.16.2+tip"><meta name=description content="Splunk Observability Workshops"><title>8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops</title><link href=https://splunk.github.io/observability-workshop/v4.90/en/other/o11y4rookies/rum/9-apm-correlation/index.html rel=canonical type=text/html title="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><link href=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/index.xml rel=alternate type=application/rss+xml title="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><link href=../../../../../images/favicon.ico?1686840499 rel=icon type=image/x-icon sizes=any><link href=../../../../../css/fontawesome-all.min.css?1686840503 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../../css/fontawesome-all.min.css?1686840503 rel=stylesheet></noscript><link href=../../../../../css/nucleus.css?1686840503 rel=stylesheet><link href=../../../../../css/auto-complete.css?1686840503 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../../css/auto-complete.css?1686840503 rel=stylesheet></noscript><link href=../../../../../css/perfect-scrollbar.min.css?1686840503 rel=stylesheet><link href=../../../../../css/fonts.css?1686840503 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../../css/fonts.css?1686840503 rel=stylesheet></noscript><link href=../../../../../css/theme.css?1686840503 rel=stylesheet><link href=../../../../../css/theme-splunk-light.css?1686840503 rel=stylesheet id=variant-style><link href=../../../../../css/variant.css?1686840503 rel=stylesheet><link href=../../../../../css/print.css?1686840503 rel=stylesheet media=print><link href=../../../../../css/format-print.css?1686840503 rel=stylesheet><link href=../../../../../css/ie.css?1686840503 rel=stylesheet><script src=../../../../../js/url.js?1686840503></script>
<script src=../../../../../js/variant.js?1686840503></script>
<script>window.index_js_url="../../../../../en/index.search.js";var root_url="../../../../../",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",window.T_No_results_found="No results found for \u0022{0}\u0022",window.T_N_results_found="{1} results found for \u0022{0}\u0022",baseUriFull="https://splunk.github.io/observability-workshop/v4.90/",window.variants&&variants.init(["splunk-light","splunk-dark","aws"])</script><style>@media screen and (min-width:1300px){#body .flex-block-wrapper{margin-left:auto;margin-right:auto;max-width:1300px;width:100%}}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/index.html><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable><div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle class=topbar-link title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../../en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../../en/other/index.html><span itemprop=name>Other Workshops</span></a><meta itemprop=position content="2">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../../en/other/o11y4rookies/index.html><span itemprop=name>Observability 4 Rookies</span></a><meta itemprop=position content="3">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../../en/other/o11y4rookies/rum/index.html><span itemprop=name>Splunk RUM</span></a><meta itemprop=position content="4">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>8. Correlate between Splunk RUM and APM backend services</span><meta itemprop=position content="5"></li></ol></div></div></nav><main id=body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=8-correlate-between-splunk-rum-and-apm-backend-services>8. Correlate between Splunk RUM and APM backend services</h1><ul><li>Continue with the RUM Session information in the RUM UI</li><li>See correlated APM traces and logs in the APM & Log Observer UI</li></ul><hr><h2 id=1-finding-backend-service-issues>1. Finding backend service issues</h2><p>Click on the
<a href=#image-50b681b59415a3bf5013271c9dc3d93e class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-JS-Error.png alt=RUM-JS style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-50b681b59415a3bf5013271c9dc3d93e><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-JS-Error.png alt=RUM-JS class=lightbox-image loading=lazy></a> to close the Span view.
Now continue to scroll down and find the <strong>POST /cart/checkout</strong> line.</p><p><a href=#image-b2fd05b2d2c0e653b2417d18c5ed7b00 class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-APM-Click.png alt=RUM-APM-Click style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-b2fd05b2d2c0e653b2417d18c5ed7b00><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-APM-Click.png alt=RUM-APM-Click class=lightbox-image loading=lazy></a></p><p>Click on the blue
<a href=#image-f2ea6a7b82e41da999f654089f2d585e class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-APM.png alt=RUM-APM-BLUE style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-f2ea6a7b82e41da999f654089f2d585e><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-APM.png alt=RUM-APM-BLUE class=lightbox-image loading=lazy></a> link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user.</p><p><a href=#image-d50e04f47f95f0b5c0c24bd957c7dbcf class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-Trace.png alt=RUM-APM-Trace style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-d50e04f47f95f0b5c0c24bd957c7dbcf><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-Trace.png alt=RUM-APM-Trace class=lightbox-image loading=lazy></a></p><p>In this popup, there are multiple sections available, providing you with a quick insight in the behavior of your backend services. For example the Performance Summary section will tell you where the time was spent during the backend call.</p><p><a href=#image-f955d190c331b6d0f389978bae1fb1a2 class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-Trace-Performance.png alt=RUM-APM-Trace-perf style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-f955d190c331b6d0f389978bae1fb1a2><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-Trace-Performance.png alt=RUM-APM-Trace-perf class=lightbox-image loading=lazy></a></p><p>In the above example you can see that more than 77,9% was spent in external services.</p><p>If you scroll down to the bottom of the dialog, you can see the complete Trace and Services section like shown below:</p><p><a href=#image-db149642c9d4de1fa9d5b9c69bbd020d class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-Trace-Services.png alt=RUM-APM-Trace-services style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-db149642c9d4de1fa9d5b9c69bbd020d><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-Trace-Services.png alt=RUM-APM-Trace-services class=lightbox-image loading=lazy></a></p><p>in the Services map, you can see two services flagged red, the <strong>Checkout</strong> Service and the <strong>Payment</strong> Service in both in dark red. Light red means it received an error and dark red means an error originated from that service.</p><p><a href=#image-86848a6d0566bb50960b6203d6339070 class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-Trace-Services-Detail.png alt=RUM-APM-Trace-services-detail style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-86848a6d0566bb50960b6203d6339070><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-Trace-Services-Detail.png alt=RUM-APM-Trace-services-detail class=lightbox-image loading=lazy></a>
So already it is obvious there is a problem in the back end services.</p><p>Let&rsquo;s investigate!</p><h2 id=2--follow-the-trace-to-the-backend-service>2. Follow the Trace to the Backend service</h2><p>You can now click on the Trace Id link:</p><p><a href=#image-73ba89eef2af6936b54b4d66c26bbfbb class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-Trace-url.png alt=RUM-APM-Trace-link style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-73ba89eef2af6936b54b4d66c26bbfbb><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-Trace-url.png alt=RUM-APM-Trace-link class=lightbox-image loading=lazy></a></p><p>This will bring you to the Waterfall APM view that will show you what occurred in detail in a call to the backend services.
On the right you see the Trace Id: and again the Performance Summary, as we saw before.
In the waterfall, you can identify the various backend services that were part of this call from the frontend.</p><p>As you can see there are red error indicators
<a href=#image-712924a88e3d139589a719dc8a1a14fa class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/APM_Error_Flag.png alt=RUM-APM-error-flag style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-712924a88e3d139589a719dc8a1a14fa><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/APM_Error_Flag.png alt=RUM-APM-error-flag class=lightbox-image loading=lazy></a>
before the <strong>Checkout</strong> Service and the <strong>Payment</strong> Service.</p><p><a href=#image-da489bb22daab9848533084ef9c89b49 class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-APM-Waterfall.png alt=RUM-APM-waterfall style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-da489bb22daab9848533084ef9c89b49><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-APM-Waterfall.png alt=RUM-APM-waterfall class=lightbox-image loading=lazy></a></p><p>Click on the
<a href=#image-43f30af226a1561d4efa47caaf7970d1 class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/APM_Error_Flag.png alt=RUM-APM-error-flag style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-43f30af226a1561d4efa47caaf7970d1><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/APM_Error_Flag.png alt=RUM-APM-error-flag class=lightbox-image loading=lazy></a> after the <strong>paymentservice: grpc.hipstershop.PaymentService/Charge</strong> line.</p><p><a href=#image-8cc5ae9b7218fbb976981aad27bdb9bd class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/payment-click.png alt=RUM-payment-click style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-8cc5ae9b7218fbb976981aad27bdb9bd><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/payment-click.png alt=RUM-payment-click class=lightbox-image loading=lazy></a></p><p>This will open the span detail page to show you the detailed information about this service call.
You wil see that the call returned a <strong>401</strong> error code or <em>Invalid Request</em>.</p><h2 id=3--use-the-related-content---logs>3. Use the Related Content - Logs</h2><p>As the Splunk Observability cloud suite correlates trace metrics and logs automatically, the system will show you in the related content bar at the bottom of the page, the corresponding logs for this trace.</p><p><a href=#image-b4d1710b5e250a46d48bb2bc1d9fd7d8 class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/log-corelation.png alt=RUM-payment-related-content style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-b4d1710b5e250a46d48bb2bc1d9fd7d8><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/log-corelation.png alt=RUM-payment-related-content class=lightbox-image loading=lazy></a></p><p>Click on the Log link to see the logs.</p><p>When the logs are shown, notice that the filter at the top of the page contains the logs for the trace.
Next select one of the lines indicating an error for the payment service.
This should open the log message on the right.</p><p>It clearly shows the reason why the payment service fails: we are using an invalid token towards the service:<br>*<strong>Failed payment processing through ButtercupPayments: Invalid API Token (test-20e26e90-356b-432e-a2c6-956fc03f5609)</strong></p><p><a href=#image-87fcc0c81cbfb8c6c049e6595fb4dc98 class=lightbox-link><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-LogObserver.png alt=RUM-logs style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-87fcc0c81cbfb8c6c049e6595fb4dc98><img src=../../../../../en/other/o11y4rookies/rum/9-apm-correlation/../../../../rum/images/RUM-LogObserver.png alt=RUM-logs class=lightbox-image loading=lazy></a></p><h2 id=4--conclusion>4. Conclusion</h2><p>In the workshop, you have seen how to add RUM functionality to you website.
We investigate the performance of your Website using RUM Metrics.
Using the Tag profile, you have searched for your own session, and with the session waterfall, you identified two problems:</p><ul><li>A Java script error that caused your price calculation to be zero.</li><li>An issue in the payment backend service that caused payments to fail.</li></ul><p>Using the ability to correlate RUM traces with the Backend APM trace and Logs, you have found the reason for the payment failure.</p><p>This concludes the RUM workshop.</p><footer class=footline></footer></article></div></main></div><script src=../../../../../js/clipboard.min.js?1686840504 defer></script>
<script src=../../../../../js/perfect-scrollbar.min.js?1686840504 defer></script>
<script src=../../../../../js/theme.js?1686840504 defer></script></body></html>